(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{r:()=>F,X:()=>$});var t=document.querySelector(".profile__edit"),n=document.querySelector(".profile__add"),o=document.querySelector(".popup_edit"),r=document.querySelector(".popup_image"),c=document.querySelectorAll(".popup__close"),u=o.querySelector(".popup__form"),a=u.querySelector(".popup__input_type_name"),i=u.querySelector(".popup__input_type_about"),l=document.querySelector(".profile__name"),s=document.querySelector(".profile__about"),d=document.querySelector(".popup-image__form"),p={id:""},f=document.querySelector(".popup__input_place-name"),m=document.querySelector(".popup__input_place-link"),_=document.querySelector(".photo-grid"),v=document.querySelector(".popup_bigImg"),y=document.querySelector(".popup_bigImg__capture"),h=document.querySelector(".popup_bigImg__image"),S=document.querySelector("#photo-item").content,b=document.querySelector(".page"),g=document.querySelector(".profile__avatar"),q=document.querySelector(".profile__btn-edit"),E=document.querySelector(".popup__edit_avatar"),L=document.querySelector(".popup__input_avatar"),k=document.querySelector(".popup-avatar__form"),C=document.querySelector(".popup__submit_avt"),O=document.querySelector(".popup-profile-submit");function x(e){e.classList.add("popup_opened"),b.addEventListener("keydown",j),b.addEventListener("mousedown",w)}function A(e){e.classList.remove("popup_opened"),b.removeEventListener("keydown",j),b.removeEventListener("mousedown",w)}function j(e){if("Escape"===e.key){var t=b.querySelector(".popup_opened");t&&A(t)}}function w(e){e.target.classList.contains("popup")&&e.target&&A(e.target)}var U=function(e,t){t.textContent=e?"Coхранение...":"Сохранить"};function P(e){var t=S.querySelector(".photo-grid__element").cloneNode(!0);t.querySelector(".photo-grid__title").textContent=e.name;var n=t.querySelector(".photo-grid__img"),o=t.querySelector(".photo-grid__delete"),r=t.querySelector(".photo-grid__like"),c=t.querySelector(".photo-grid__like-counter"),u=e._id;return p.id==e.owner._id&&o.classList.add("photo-grid__delete_active"),e.likes.forEach((function(e){p.id==e._id&&r.classList.add("photo-grid__like_active")})),$(o,t,u),F(r,u,c),T(c,e),n.src=e.link,n.alt=e.name,n.addEventListener("click",(function(){var t,n;t=e.link,n=e.name,x(v),h.src=t,h.alt=n,y.textContent=n})),t}function T(e,t){e.textContent=t.likes.length}var I=["inputSelector","submitButtonSelector"];function D(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},c=Object.keys(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var M,N,B,J=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.disabled=!1:t.disabled=!0},H={baseUrl:"https://nomoreparties.co/v1/plus-cohort-11",headers:{authorization:"62c62206-0004-4679-a9cb-fddfb5975681","Content-Type":"application/json"}};function z(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status," ").concat(e.statusText))}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function $(e,t,n){e.addEventListener("click",(function(){(function(e){return fetch("".concat(H.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:H.headers}).then(z)})(n).then((function(){t.remove()})).catch((function(e){console.log(e.message)}))}))}function F(e,t,n){e.addEventListener("click",(function(){e.classList.contains("photo-grid__like_active")?function(e){return fetch("".concat(H.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:H.headers}).then(z)}(t).then((function(t){e.classList.remove("photo-grid__like_active"),T(n,t)})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(H.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:H.headers}).then(z)}(t).then((function(t){e.classList.add("photo-grid__like_active"),T(n,t)})).catch((function(e){console.log(e.message)}))}))}Promise.all([fetch("".concat(H.baseUrl,"/users/me"),{headers:H.headers}).then((function(e){return z(e)})),fetch("".concat(H.baseUrl,"/cards"),{headers:H.headers}).then((function(e){return z(e)}))]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],u=!0,a=!1;try{for(n=n.call(e);!(u=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);u=!0);}catch(e){a=!0,r=e}finally{try{u||null==n.return||n.return()}finally{if(a)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],c=o[1];g.src=r.avatar,l.textContent=r.name,s.textContent=r.about,p.id=r._id,c.forEach((function(e){_.append(P(e))})),console.log(c)})).catch((function(e){console.log(e)})),q.addEventListener("click",(function(){x(E)})),k.addEventListener("submit",(function(e){var t;U(!0,C),e.preventDefault(),(t=L.value,fetch("".concat(H.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:H.headers,body:JSON.stringify({avatar:t})}).then((function(e){return z(e)}))).then((function(e){console.log(e),g.src=L.value,A(E)})).catch((function(e){console.log(e.message)})).finally((function(){U(!1,C)}))})),t.addEventListener("click",(function(){a.value=l.textContent,i.value=s.textContent,x(o)})),n.addEventListener("click",(function(){x(r)})),c.forEach((function(e){e.addEventListener("click",(function(){A(document.querySelector(".popup_opened"))}))})),u.addEventListener("submit",(function(e){var t,n;U(!0,O),e.preventDefault(),(t=a.value,n=i.value,fetch("".concat(H.baseUrl,"/users/me"),{method:"PATCH",headers:H.headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return z(e)}))).then((function(e){l.textContent=e.name,i.value=e.about,A(o)})).catch((function(e){console.log(e.message)})).finally((function(){U(!1,O)}))})),d.addEventListener("submit",(function(e){var t,n;(t=f.value,n=m.value,fetch("".concat(H.baseUrl,"/cards"),{method:"POST",headers:H.headers,body:JSON.stringify({name:t,link:n})}).then(z)).then((function(e){var t;t=e,_.prepend(P(t)),A(r),f.value="",m.value=""})).catch((function(e){console.log(e.message)}));var o=r.querySelector(".popup__submit");o.disabled=!0,o.classList.add("popup__submit_disabled")})),N=(M={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inputErrorClass:"popup__input-error",errorClass:".popup__input-error_active"}).formSelector,B=D(M,["formSelector"]),Array.from(document.querySelectorAll(N)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=t.inputSelector,o=t.submitButtonSelector,r=D(t,I),c=Array.from(e.querySelectorAll(n)),u=e.querySelector(o);J(c,u),c.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=n.inputErrorClass,r=n.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(o),c.textContent="",c.classList.remove(r)}(e,t,n):function(e,t,n,o){var r=o.inputErrorClass,c=o.errorClass,u=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r),u.textContent=n,u.classList.add(c)}(e,t,function(e,t){return"url"===e.type.toString()&&e.validity.typeMismatch,e.validity.valueMissing?"Вы пропустили это поле.":e.validationMessage}(t),n)}(e,t,r),J(c,u)}))}))}(e,B)}))})();